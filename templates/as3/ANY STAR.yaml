title: ANY Application Template
description: This template aims to provide a jumping point for taking an NS app config and converting it to AS3.
contentType: application/json
definitions:
  tenant_name:
    title: Tenant name
    type: string
    propertyOrder: 1
  app_name:
    title: Application name
    type: string
    propertyOrder: 2
    options:
      input_width: 300px
  virtual_address:
    title: Virtual address
    propertyOrder: 3
    type: string
    options:
      input_width: 300px
  virtual_port:
    title: Virtual port
    propertyOrder: 4
    default: 80
    type: integer
    options:
      input_width: 300px
  icmp_echo:
    type: string
    title: ICMP echo
    enum:
      - enable
      - disable
      - selective
    default: enable
  arpEnabled:
    title: ARP enabled
    type: boolean
    default: true
  idleTimeout:
    type: integer 
    propertyOrder: 5
    default: 300
    title: Idle timeout
    options:
      input_width: 300px
  persistence:
    title: Persistence
    propertyOrder: 6
    type: string
    enum:
      - source_addr
      - cookie
      - ssl
    default: cookie
    options:
      input_width: 200px
  lbMethod:
    title: Load balancing method
    type: string
    enum:
      - round-robin
      - least-connections-member
    default: least-connections-member
    propertyOrder: 7
    options:
      input_width: 300px
  pool_members:
    title: Static Pool members
    description: List of static pool members
    uniqueItems: true
    type: array
    items:
      type: object
      properties:
        name:
          title: Name
          type: string
          propertyOrder: 1
        address:
          title: Address
          type: string
          propertyOrder: 2
        port:
          title: Port
          type: number
          propertyOrder: 3
          options:
            input_width: 80px
        shareNodes:
          title: Shared nodes
          type: boolean
          default: false
          propertyOrder: 4
        adminState:
          title: Admin State
          description: Enabled
          type: boolean
          default: true
      required:
        - port
        - address
  fqdn_members:
    title: FQDN Pool members
    description: List of FQDN pool members details
    uniqueItems: true
    type: array
    items:
      type: object
      properties:
        hostname:
          title: FQDN
          type: string
        port:
          title: Port
          type: string
        adminState:
          title: Admin State
          description: Enabled
          type: boolean
          default: true
        shareNodes:
          title: Shared nodes
          type: boolean
          default: false
      required:
        - hostname
        - port
template: |
    {
        "$schema": "https://raw.githubusercontent.com/F5Networks/f5-appsvcs-extension/master/schema/latest/as3-schema.json",
        "class": "AS3",
        "declaration": {
            "class": "ADC",
            "schemaVersion": "3.37.0",
            "id": "urn:uuid:86ab3731-c523-419d-b09d-512a61bf8865",
            "label": "Converted Declaration",
            "remark": "Generated by Automation Config Converter",
            "t_{{virtual_address}}": {
                "class": "Tenant",
                "{{app_name}}-app": {
                    "class": "Application",
                    "template": "shared",
                        "{{virtual_address}}_sa": {
                            "class": "Service_Address",
                            "icmpEcho": {{icmp_echo}},
                            "arpEnabled": {{arpEnabled}},
                            "virtualAddress": "{{virtual_address}}"
                        },
                        "{{app_name}}": {
                        "pool": "pool_{{app_name}}",
                        "translateServerAddress": true,
                        "translateServerPort": false,
                        "class": "Service_L4",
                        "profileL4": {
                            "bigip": "/Common/fastL4"
                        },
                        "virtualPort": {{virtual_port}},
                        "snat": "auto",
                        "virtualAddresses": [
                            { "use": "{{virtual_address}}_sa" }
                        ],
                        "layer4": "any"
                    },
                    "pool_{{app_name}}": {
                        "loadBalancingMode": "least-connections-member",
                        "members": [
                        {{#pool_members}}
                        {
                        "addressDiscovery": "static",
                        "servers": [{
                        {{#name}}
                            "name": "{{name}}",
                        {{/name}}
                            "address": "{{address}}"
                        }],
                        "servicePort": {{port}},
                        {{#shareNodes}}"shareNodes": true,{{/shareNodes}}
                        {{^adminState}}"adminState": "disable"{{/adminState}}
                        },
                        {{/pool_members}}
                        {{#fqdn_members}}
                        {
                        "addressDiscovery": "fqdn",
                        "hostname": {{hostname}},
                        "servicePort": {{port}},
                        {{#shareNodes}}"shareNodes": true,{{/shareNodes}}
                        {{^adminState}}"adminState": "disable"{{/adminState}}
                        },
                        {{/fqdn_members}}
                        ],
                        "monitors": [
                            {
                                "bigip": "/Common/gateway_icmp"
                            }
                        ],
                        "class": "Pool"
                    }
                }
            }
        }
    }